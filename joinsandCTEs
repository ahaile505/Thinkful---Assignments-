--What are the three longest trips on rainy days?

SELECT DATE(w.date),t.trip_id,t.duration
FROM weather w
JOIN trips t
ON DATE(w.date)=DATE(t.start_date)
WHERE w.events = 'Rain'
GROUP BY 1,2,3
ORDER BY t.duration DESC
LIMIT 3;

--Which station is full most often?

SELECT 
	stations.station_id,
	stations.name,
	status.docks_available,
	count(*)
FROM 
	stations
JOIN 
	status
ON 
	stations.station_id=status.station_id
WHERE 
	status.docks_available=0
GROUP BY 1,2,3
ORDER BY count(*) DESC;

--Return a list of stations with a count of number of trips starting at that station but ordered by dock count.

SELECT 
	t.start_station, 
	s.dockcount, 
	count(*)
FROM 
	trips t
Join 
	stations s
ON 
	t.start_station=s.name
GROUP BY 1,2
ORDER BY 2 DESC;

--(Challenge) What's the length of the longest trip for each day it rains anywhere?

SELECT 
	DATE(t.start_date) as Date, 
	w.events, 
	max(t.duration) as Longest_trip
From 
	trips t
JOIN 
	weather w
ON 
	DATE(t.start_date)=DATE(w.date)
Where 
	w.events='Rain'
GROUP BY 1,2
ORDER BY Longest_trip DESC;